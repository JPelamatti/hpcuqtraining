

\documentclass[8pt]{beamer}

\include{macros}
\usepackage{Math_Notations}
\usepackage{color}

\title[Sensitivity analyses]{Sensitivity analyses}

\author[EDF R\&D]{
Anne Dutfoy
}

\institute[]{
 EDF R\&D. \\
 anne.dutfoy@edf.Fr
}


\date[PRACE training]{PRACE training}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  \begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[plain]
  \begin{columns}
    \column{0.5\textwidth}
    \column{0.5\textwidth}
    \titlepage
    \vfill
  \end{columns}
%\titlepage
\end{frame}

\setbeamertemplate{background canvas}{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}
  \begin{columns}
    \column{0.4\textwidth}
    \pgfuseimage{sommaire}

    \column{0.6\textwidth}
    {\usebeamercolor[fg]{title page}\huge{Sommaire}}
    \vspace{1cm}
    \small{\tableofcontents}
%\begin{center}
%     \includegraphics[width=0.5\textwidth]{figures/logo-ot}
%\end{center}
  \end{columns}
\end{frame}





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}


\begin{frame}
  \frametitle{Contexte}
  \begin{block}{Etudes de traitement des incertitudes}
\small{
    \alert{\bf L'objectif des études de traitement des incertitudes est de propager les incertitudes entâchant certaines données d'entrée d'un modèle numérique jusqu'à un grandeur dite d'{\itshape intérêt}}.\\
    \vspace*{0.2cm}
On considère : $Y=f(X_1, \dots, X_n)$ où :
\begin{itemize}
  \item $g$ est un {\bf modèle} (code de calcul, expression analytique, ...)
  \item $(X_1, \dots, X_n)$ est l'ensemble  {\bf des paramètres incertains} que l'on modélise par une loi de probabilité
  \item $Y$ est la {\bf grandeur d'intérêt} évaluée par le modèle, supposée ici scalaire.
\end{itemize}
\vspace*{0.2cm}
Une fois les incertitudes quantifiées et propagées jusqu'au critère final (tendance centrale, dépasssement de seuil), la dernière étape de la {\bf Méthodologie Globale de Traitement des Incertitudes} est de hiérarchiser les sources d'incertitudes entre elle.
}
\end{block}

\begin{block}{Trois notions}
\small{
Les \alert{\bf facteurs d'importance} se rattachent à la {\bf décomposition de la variance} et permettent d'expliquer la variabilité de $Y$ en fonction des variabilités des entrées $X_i$.\\
Les \alert{\bf corrélations} sont des indicateurs de {\bf relation linéaire} entre $Y$ et les entrées $X_i$.\\
Les \alert{\bf sensibilités} sont des indicateurs de {\bf dépendance locale} reposant sur l'évaluation de {\bf gradients} par rapport à des grandeurs caractéristiques des entrées.\\
Selon la {\bf structure du modèle}$f$, les indices sont définis différemment.
}
\end{block}
\end{frame}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Sobol indices}



\begin{frame}
\frametitle{Sobol indices}
\begin{block}{Décomposition de Sobol d'une fonction intégrable sur $[0,1]^n$}
\textit{Si $f$ est intégrable sur $[0,1]^n$, elle admet une unique décompositin du type : }
\begin{equation}
\label{decompSobol}
 f(x_1, \dots, x_n) = f_0 + \sum_{i=1}^{i=n}f_i(x_i) + \sum_{1\leq i < j \leq n} f_{i,j} (x_i, x_j) + \dots + f_{1, \dots, n}(x_1, \dots, x_n)
\end{equation}
\textit{où} $f_0 = cst$ \textit{et les fonctions de la décomposition sont orthogonales entre elles par rapport à la mesure de Lebesgue sur} $[0,1]^n$ :
\begin{equation}
\label{decompSobolCondOrthog}
 \int_0^1 f_{i_1, \dots, i_s}(x_{i_1}, \dots, x_{i_s})f_{j_1, \dots, j_k}(x_{j1}, \dots, x_{j_k}) d\vect{x} = 0
\end{equation}
\textit{dès lors que} $(i_1, \dots, i_s) \neq (j_1, \dots, j_k)$.
\end{block}

\end{frame}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Sobol indices}
Comment utiliser ce r\'esultat pour $Y = f(\vect{X})$ avec $\vect{X}$ vecteur al\'eatoire?


\begin{block}{Comment utiliser ce résultat ?}
    \small
      On aimerait décomposer le modèle $f$ selon la décomposition de Sobol ... mais : \\
      \begin{enumerate}
      \item  \alert{\bf Les entrées de $f$ ne sont pas sur $[0,1]^n$} :  dans le cas général, $Y=f(\vect{X})$ où $\vect{X}$ est défini sur $\mathbb{R}$.
      \end{enumerate}
      \alert{$\Longrightarrow$} Si on pose
       \begin{equation}
         \label{phi}
         \vect{U} = (F_1(X_1), \dots, F_n(X_n))^t) = \phi^{-1}(\vect{X})
       \end{equation}
       alors on montre que $\vect{U}$ a une loi jointe de marginales uniformes et de copule celle de $\vect{X}$.\\
       En posant $Y = f(\vect{X}) = f \circ \phi (\vect{U})$, alors {\bf on peut utiliser la décomposition de Sobol sur $f \circ \phi$}.

       \begin{enumerate}
       \item  \alert{\bf Les indices de Sobol par rapport aux $U_i$ sont-ils les mêmes que ceux par rapport aux $X_i$ ?}
       \end{enumerate}
       \alert{$\Longrightarrow$} Rappel : Si $\vect{U} = \psi(\vect{X})$ où $\psi$ est un difféomorphisme et $Y=f(\vect{X})$ alors :

       \begin{equation}
         \label{varCond}
         \Expect{Y|\vect{U}} = \Expect{Y|\vect{X}}
       \end{equation}
       En effet : $\Expect{Y|\vect{U}} = \Expect{Y|\psi(\vect{X})}$ est le projeté orthogonal au sens $L_2$ de $Y$ sur l'espace engendré par $\psi(\vect{X})$, ie celui engendré par $\vect{X}$, d'où l'égalité des variables aléatoires (\ref{varCond}).\\
       Comme la transformation $\phi$ (\ref{phi}) agit composante par composante ($U_i \leftrightarrow X_i$) alors on a l'égalité des indicateurs de type :
       \begin{equation}
         \label{varCond}
         \Var{\Expect{Y|U_{i_1}, \dots, U_{i_k}}} = \Var{\Expect{Y|X_{i_1}, \dots, X_{i_k}}}
       \end{equation}
       d'où {\bf l'égalité des indices de Sobol par rapport aux $U_i$ et aux $X_i$}.
  \end{block}

\end{frame}




\begin{frame}
  \frametitle{Sobol indices}
  \begin{block}{Interprétation probabiliste de la décomposition de Sobol}
    \alert{\bf Supposons, sans perdre en généralité, que les variables $X_i$ soient à support $[0,1]$}. Alors en décomposant le modèle $f$ selon la décomposition de Sobol (\ref{decompSobol}), on écrit :
    \begin{equation}
      \label{decompSobolY}
      Y = f(\vect{X}) = f_0 + \sum_{i=1}^{i=n}f_i(X_i) + \sum_{1\leq i < j \leq n} f_{i,j} (X_i, X_j) + \dots + f_{1, \dots, n}(X_1, \dots, X_n)
    \end{equation}
    {\bf La condition d'orthogonalité (\ref{decompSobolCondOrthog}) des $f_{i_1, \dots, i_k}$  par rapport à la mesure de Lebesgue sur $[0,1]^n$ s'interprète comme un calcul d'expérance si les $X_i$ sont indépendantes}.\\
    \alert{$\Longrightarrow$} On suppose donc que dans la suite, les $X_i$ sont \alert{\bf indépendantes}.\\

    \alert{\bf Conclusion} : \\
    Y se décompose sous la forme d'une somme de {\bf variables aléatoires orthogonales} entre elles :
    \begin{equation}
      \label{decompSobolY2}
      \boldsymbol{ Y = f(\vect{X}) = Z_0 + \sum_{i=1}^{i=n}Z_i + \sum_{1\leq i < j \leq n} Z_{i,j}  + \dots + Z_{1,} \dots, n}
    \end{equation}
    où $Z_0 = cst$ et $Z_{i_1, \dots, i_s} \bot  Z_{j_1, \dots, j_k}$ (ie $\Expect{Z_{i_1, \dots, i_s}.Z_{j_1, \dots, j_k}}=0$).
  \end{block}
\end{frame}


\begin{frame}
  \frametitle{Sobol indices}
  \begin{block}{Calcul des Indices de Sobol}
    \small{
      Grâce à la décomposition probabiliste (\ref{decompSobolY2}), on calcule $\Expect{Y}$ et $\Var{Y}$ aisément :
      $$
      \left\{
        \begin{array}{l}
          \Expect{Y}  =  Z_0 + \sum_{i=1}^{i=n}\underbrace{\Expect{Z_i}}_{=0 \mbox{ car } \bot Z_0} + \sum_{1\leq i < j \leq n} \underbrace{\Expect{Z_{i,j}}}_{=0 \mbox{ car } \bot Z_0}  + \dots + \underbrace{\Expect{Z_{1,} \dots, n}}_{=0 \mbox{ car } \bot Z_0}  \\[2em]
          \Expect{Y^2}   =   \sum_{I \neq J} \underbrace{\Expect{Z_IZ_J}}_{=0 \mbox{ car } \bot \mbox{ des } Z_I} + \sum_I \Expect{Z_I^2}  \sum_I \Expect{Z_I^2}
        \end{array}
      \right.
      $$
      \begin{eqnarray}
        \label{VarY}
        \Longrightarrow \boldsymbol{\Var{Y} = \sum_{i=1}^{i=n} V_i + \sum_{1\leq i < j \leq n} V_{i,j}  + \dots + V_{1, \dots, n}}
      \end{eqnarray}
      où $V_{i_1, \dots, i_k} = \Var{Z_{i_1, \dots, i_k}} = \Var{f_{i_1, \dots, i_k}(X_{i_1}, \dots, X_{i_k})}$.
    }
  \end{block}
\end{frame}




\begin{frame}
\frametitle{Sobol indices}
  \begin{block}{Calcul des Indices de Sobol}
\alert{\bf Les indices de Sobol (\ref{SobolOrdrek}) et (\ref{SobolTotalOrdrek}) s'expriment en fonction des $V_{i_1, \dots, i_k}$} :

      \begin{eqnarray}
        \label{SobolOrdrekViCalcul}
        \displaystyle S_{i_1, \dots, i_k} & = & \frac{\Var{ \Expect{Y|X_{i_1}, \dots, X_{i_k}} }}{\Var{Y}} = \frac{ \sum_{I \subset \{i_1, \dots, i_k\}} V_I}{\Var{Y}} \\
        \label{SobolTotalOrdrekCalcul}
        \displaystyle S^T_{i_1, \dots, i_k} & =& \frac{\sum_I\Var{\Expect{Y|X_{I}}}}{\Var{Y}} =   \frac{\sum_I \sum_J V_J}{\Var{Y}} \\
        & \mbox{où} & I\subset \{1, \dots, n \},  I \cap \{i_1, \dots, i_k\} \neq \emptyset , J \subset I
      \end{eqnarray}

  \end{block}
\end{frame}




\begin{frame}
\frametitle{Sobol indices}
\begin{block}{Décomposition de la variance}
De manière très générale, si $Y=f(\vect{X})$, avec X \`a composante sind\'ependnates, alors on peut décomposer la variance comme suit :
\begin{equation}
\label{decompVar}
Var(Y) = \sum_i \Var{\Expect{Y|X_i}} + \sum_{i \neq j} \Var{\Expect{Y|X_i,X_j}} + \dots + \underbrace{\Var{\Expect{Y|X_1,\dots, X_n}}}_{=0}
\end{equation}
\end{block}


\begin{block}{Sobol indices}
L'\alert{\bf indice de Sobol d'ordre $k$} donne la variance résiduelle de $Y$ lorsque les entrées $X_{i_1},\dots, X_{i_k}$ sont connues (et donc plus aléatoires) :

\begin{equation}
\label{SobolOrdrek}
\displaystyle S_{i_1, \dots, i_k} =\frac{\Var{\Expect{Y|X_{i_1}, \dots, X_{i_k}}}}{\Var{Y}}
\end{equation}

L'\alert{\bf indice total de Sobol d'ordre $k$} donne la variance  de $Y$ due aux entrées $X_{i_1},\dots, X_{i_k}$ lorsque toutes les autres sont connues (et donc plus aléatoires) :
\begin{equation}
\label{SobolTotalOrdrek}
\displaystyle S^T_{i_1, \dots, i_k} =\frac{\sum_I\Var{\Expect{Y|X_{I}}}}{\Var{Y}},\, \, I\subset \{1, \dots, n \}-\{i_1, \dots, i_k\}
\end{equation}

\end{block}
\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
















%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Taylor variance decomposition}



\end{document}


